<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chord Progression Helper</title>
    <style>
      /* --- Color & Style Variables --- */
      :root {
        --bg-color: #2c3e50;
        --card-bg: #34495e;
        --text-color: #ecf0f1;
        --roman-color: #95a5a6;

        /* Chord Quality Colors */
        --major-color: #3498db; /* Blue */
        --minor-color: #9b59b6; /* Amethyst Purple */
        --secondary-color: #1abc9c; /* Teal for Secondary Dominant */
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
          Arial, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
        box-sizing: border-box;
      }

      /* --- Main App Container --- */
      .container {
        background-color: var(--card-bg);
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        text-align: center;
        max-width: 950px;
        width: 100%;
      }

      /* --- Key Selector Dropdown --- */
      .key-selector {
        font-size: 1.2em;
        padding: 10px 15px;
        border-radius: 8px;
        border: 2px solid var(--major-color);
        background-color: var(--bg-color);
        color: var(--text-color);
        margin-bottom: 40px;
        cursor: pointer;
      }

      /* --- Chords Display Area --- */
      .chords-display {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .chord-card {
        background-color: var(--bg-color);
        border-radius: 10px;
        padding: 20px;
        border-top: 5px solid transparent;
        flex: 1 1 100px;
        min-width: 100px;
        max-width: 150px;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease,
          border-top-color 0.3s ease;
      }

      .chord-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
      }

      /* --- CHANGE 1: Make the third card clickable --- */
      #iii-card {
        cursor: pointer;
      }

      .roman-numeral {
        font-size: 1.5em;
        font-weight: bold;
        color: var(--roman-color);
        margin-bottom: 10px;
      }

      .chord-name {
        font-size: 2.2em;
        font-weight: bold;
        transition: color 0.3s ease;
      }

      /* --- Chord Quality Styling --- */
      .chord-card.chord-major .chord-name {
        color: var(--major-color);
      }
      .chord-card.chord-major {
        border-top-color: var(--major-color);
      }

      .chord-card.chord-minor .chord-name {
        color: var(--minor-color);
      }
      .chord-card.chord-minor {
        border-top-color: var(--minor-color);
      }

      .chord-card.chord-secondary .chord-name {
        color: var(--secondary-color);
      }
      .chord-card.chord-secondary {
        border-top-color: var(--secondary-color);
      }

      /* --- Mobile Responsiveness --- */
      @media (max-width: 600px) {
        .container {
          padding: 20px;
        }
        .chord-name {
          font-size: 1.8em;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <select id="key-select" class="key-selector">
        <option value="C">C</option>
        <option value="C#">C# / Db</option>
        <option value="D">D</option>
        <option value="D#">D# / Eb</option>
        <option value="E">E</option>
        <option value="F">F</option>
        <option value="F#">F# / Gb</option>
        <option value="G">G</option>
        <option value="G#">G# / Ab</option>
        <option value="A">A</option>
        <option value="A#">A# / Bb</option>
        <option value="B">B</option>
      </select>

      <div id="chords-display" class="chords-display">
        <div class="chord-card">
          <div class="roman-numeral">I</div>
          <div class="chord-name">C</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">ii</div>
          <div class="chord-name">Dm</div>
        </div>
        <!-- CHANGE 2: Added an ID to the third card for easy access -->
        <div class="chord-card" id="iii-card">
          <div class="roman-numeral">iii</div>
          <div class="chord-name">Em</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">IV</div>
          <div class="chord-name">F</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">V</div>
          <div class="chord-name">G</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">vi</div>
          <div class="chord-name">Am</div>
        </div>
      </div>
    </div>

    <script>
      // --- DATA ---
      const notes = [
        "C",
        "C#",
        "D",
        "D#",
        "E",
        "F",
        "F#",
        "G",
        "G#",
        "A",
        "A#",
        "B",
      ];
      const majorScalePattern = [2, 2, 1, 2, 2, 2, 1];
      const romanNumerals = ["I", "ii", "iii", "IV", "V", "vi"];
      const chordQualities = [
        "major",
        "minor",
        "minor",
        "major",
        "major",
        "minor",
      ];
      const chordSuffixes = ["", "m", "m", "", "", "m"];

      // --- DOM ELEMENTS ---
      const keySelect = document.getElementById("key-select");
      const chordCards = document.querySelectorAll(".chord-card");
      const iiiCard = document.getElementById("iii-card");

      // --- CORE LOGIC ---
      function updateChords() {
        const selectedKey = keySelect.value;
        const rootIndex = notes.indexOf(selectedKey);

        const scaleNotes = [];
        let currentIndex = rootIndex;
        scaleNotes.push(notes[currentIndex]);
        for (const step of majorScalePattern.slice(0, 5)) {
          currentIndex = (currentIndex + step) % 12;
          scaleNotes.push(notes[currentIndex]);
        }

        chordCards.forEach((card, i) => {
          card.querySelector(".roman-numeral").textContent = romanNumerals[i];
          card.querySelector(".chord-name").textContent =
            scaleNotes[i] + chordSuffixes[i];
          card.className = `chord-card chord-${chordQualities[i]}`;
        });

        // Add the ID back to the iii-card after its class is reset
        iiiCard.id = "iii-card";
      }

      // --- CHANGE 3: Click listener to toggle the iii card ---
      function toggleSecondaryDominant() {
        const romanEl = iiiCard.querySelector(".roman-numeral");
        const nameEl = iiiCard.querySelector(".chord-name");

        // Check current state by looking at the roman numeral
        if (romanEl.textContent === "iii") {
          // Change to Secondary Dominant (V/vi)
          romanEl.textContent = "V/vi";
          nameEl.textContent = nameEl.textContent.replace("m", ""); // Remove 'm' to make it major
          iiiCard.className = "chord-card chord-secondary";
          iiiCard.id = "iii-card"; // Ensure ID persists
        } else {
          // Change back to diatonic iii
          romanEl.textContent = "iii";
          nameEl.textContent += "m"; // Add 'm' back to make it minor
          iiiCard.className = "chord-card chord-minor";
          iiiCard.id = "iii-card"; // Ensure ID persists
        }
      }

      // --- EVENT LISTENERS ---
      keySelect.addEventListener("change", updateChords);
      iiiCard.addEventListener("click", toggleSecondaryDominant);

      // --- INITIALIZATION ---
      updateChords();
    </script>
  </body>
</html>
