<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chord Progression Helper</title>
    <style>
      /* --- Color & Style Variables --- */
      :root {
        --bg-color: #1a1a1a;
        --card-bg: #2a2a2a;
        --text-color: #ffffff;
        --roman-color: #999999;

        /* Chord Quality Colors - High contrast */
        --major-color: #00d4ff; /* Bright cyan */
        --minor-color: #ff6b9d; /* Bright pink */
        --secondary-color: #00ff88; /* Bright green */

        /* Effects */
        --shadow-color: rgba(0, 0, 0, 0.6);
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family:
          "SF Pro Display",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
      }

      /* --- Main App Container --- */
      .container {
        background: var(--card-bg);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 40px var(--shadow-color);
        text-align: center;
        max-width: 1200px;
        width: 100%;
      }

      /* --- Key Selector Dropdown --- */
      .key-selector {
        font-size: 1.3em;
        font-weight: 600;
        padding: 15px 20px;
        border-radius: 12px;
        border: none;
        background: var(--bg-color);
        color: var(--text-color);
        margin-bottom: 40px;
        cursor: pointer;
        outline: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.2s ease;
      }

      .key-selector:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      }

      /* --- Chords Display Area --- */
      .chords-display {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .chord-card {
        background: var(--bg-color);
        border-radius: 15px;
        padding: 25px 20px;
        border-top: 6px solid transparent;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        flex: 1;
        min-width: 140px;
        max-width: 180px;
      }

      .chord-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      }

      #iii-card {
        cursor: pointer;
      }

      #iii-card:hover {
        transform: translateY(-10px) scale(1.05);
      }

      .roman-numeral {
        font-size: 1.4em;
        font-weight: 300;
        color: var(--roman-color);
        margin-bottom: 12px;
        letter-spacing: 1px;
      }

      .chord-name {
        font-size: 2.8em;
        font-weight: 900;
        transition: all 0.3s ease;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      /* --- CHANGE 1: Styling for the new chord notes element --- */
      .chord-notes {
        margin-top: 15px;
        font-size: 1em;
        font-weight: 400;
        color: var(--roman-color);
        letter-spacing: 2px;
        opacity: 0.8;
        transition: all 0.3s ease;
        word-spacing: 10px;
      }

      /* --- MAJOR CHORDS --- */
      .chord-card.chord-major {
        border-top-color: var(--major-color);
      }
      .chord-card.chord-major .chord-name {
        color: var(--major-color);
        text-transform: uppercase;
        font-weight: 900;
        filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.3));
      }
      .chord-card.chord-major .roman-numeral {
        text-transform: uppercase;
        font-weight: 700;
        color: #cccccc;
      }

      /* --- MINOR CHORDS --- */
      .chord-card.chord-minor {
        border-top-color: var(--minor-color);
      }
      .chord-card.chord-minor .chord-name {
        color: var(--minor-color);
        font-weight: 600;
        font-style: italic;
        filter: drop-shadow(0 0 10px rgba(255, 107, 157, 0.3));
      }
      .chord-card.chord-minor .roman-numeral {
        text-transform: lowercase;
        font-weight: 300;
        font-style: italic;
        color: #aaaaaa;
      }

      /* --- SECONDARY DOMINANT --- */
      .chord-card.chord-secondary {
        border-top-color: var(--secondary-color);
      }
      .chord-card.chord-secondary .chord-name {
        color: var(--secondary-color);
        font-weight: 800;
        filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.3));
      }
      .chord-card.chord-secondary .roman-numeral {
        font-size: 1.2em;
        font-weight: 600;
        color: #bbbbbb;
      }

      /* --- Media Queries --- */
      @media (min-width: 769px) {
        .chords-display {
          flex-wrap: nowrap;
        }
        .chord-card {
          flex: 1;
          min-width: 0;
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 30px 20px;
        }
        .chords-display {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 15px;
        }
        .chord-card {
          padding: 20px 15px;
          min-width: 0;
          max-width: none;
        }
        .chord-name {
          font-size: 2.2em;
        }
        .chord-notes {
          font-size: 0.9em;
          margin-top: 12px;
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: 25px 15px;
        }
        .chords-display {
          gap: 12px;
        }
        .chord-name {
          font-size: 1.9em;
        }
        .chord-notes {
          font-size: 0.8em;
          letter-spacing: 1px;
        }
        .key-selector {
          font-size: 1.1em;
          padding: 12px 16px;
        }
      }

      .loading * {
        transition: none !important;
        transform: none !important;
        animation: none !important;
      }
      .loading .chord-card:hover {
        transform: none !important;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3) !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <select id="key-select" class="key-selector">
        <option value="C">C</option>
        <option value="C#">C# / Db</option>
        <option value="D">D</option>
        <option value="D#">D# / Eb</option>
        <option value="E">E</option>
        <option value="F">F</option>
        <option value="F#">F# / Gb</option>
        <option value="G">G</option>
        <option value="G#">G# / Ab</option>
        <option value="A">A</option>
        <option value="A#">A# / Bb</option>
        <option value="B">B</option>
      </select>

      <div id="chords-display" class="chords-display">
        <!-- CHANGE 2: Added the chord-notes div to each card -->
        <div class="chord-card">
          <div class="roman-numeral">I</div>
          <div class="chord-name">C</div>
          <div class="chord-notes">C E G</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">ii</div>
          <div class="chord-name">Dm</div>
          <div class="chord-notes">D F A</div>
        </div>
        <div class="chord-card" id="iii-card">
          <div class="roman-numeral">iii</div>
          <div class="chord-name">Em</div>
          <div class="chord-notes">E G B</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">IV</div>
          <div class="chord-name">F</div>
          <div class="chord-notes">F A C</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">V</div>
          <div class="chord-name">G</div>
          <div class="chord-notes">G B D</div>
        </div>
        <div class="chord-card">
          <div class="roman-numeral">vi</div>
          <div class="chord-name">Am</div>
          <div class="chord-notes">A C E</div>
        </div>
      </div>
    </div>

    <script>
      // --- DATA ---
      const notes = [
        "C",
        "C#",
        "D",
        "D#",
        "E",
        "F",
        "F#",
        "G",
        "G#",
        "A",
        "A#",
        "B",
      ];
      const majorScalePattern = [2, 2, 1, 2, 2, 2, 1];
      const romanNumerals = ["I", "ii", "iii", "IV", "V", "vi"];
      const chordQualities = [
        "major",
        "minor",
        "minor",
        "major",
        "major",
        "minor",
      ];
      const chordSuffixes = ["", "m", "m", "", "", "m"];

      // --- DOM ELEMENTS ---
      const keySelect = document.getElementById("key-select");
      const chordCards = document.querySelectorAll(".chord-card");
      const iiiCard = document.getElementById("iii-card");

      // --- CHANGE 3: New helper function to calculate chord notes ---
      function getChordNotes(rootNote, quality) {
        const rootIndex = notes.indexOf(rootNote);
        const thirdIndex = (rootIndex + (quality === "major" ? 4 : 3)) % 12;
        const fifthIndex = (rootIndex + 7) % 12;

        const root = notes[rootIndex];
        const third = notes[thirdIndex];
        const fifth = notes[fifthIndex];

        return `${root} ${third} ${fifth}`;
      }

      // --- CORE LOGIC ---
      function updateChords() {
        const selectedKey = keySelect.value;
        const rootIndex = notes.indexOf(selectedKey);

        const scaleNotes = [];
        let currentIndex = rootIndex;
        scaleNotes.push(notes[currentIndex]);
        for (const step of majorScalePattern.slice(0, 5)) {
          currentIndex = (currentIndex + step) % 12;
          scaleNotes.push(notes[currentIndex]);
        }

        chordCards.forEach((card, i) => {
          const rootNote = scaleNotes[i];
          const quality = chordQualities[i];

          card.querySelector(".roman-numeral").textContent = romanNumerals[i];
          card.querySelector(".chord-name").textContent =
            rootNote + chordSuffixes[i];
          // Update the chord notes display
          card.querySelector(".chord-notes").textContent = getChordNotes(
            rootNote,
            quality,
          );

          card.className = `chord-card chord-${quality}`;
        });

        iiiCard.id = "iii-card";
      }

      // --- Click listener to toggle the iii card ---
      function toggleSecondaryDominant() {
        const romanEl = iiiCard.querySelector(".roman-numeral");
        const nameEl = iiiCard.querySelector(".chord-name");
        const notesEl = iiiCard.querySelector(".chord-notes");
        const rootNote = nameEl.textContent.replace("m", "");

        if (romanEl.textContent === "iii") {
          // Change to Secondary Dominant (V/vi)
          romanEl.textContent = "V/vi";
          nameEl.textContent = rootNote;
          notesEl.textContent = getChordNotes(rootNote, "major"); // Update notes to major
          iiiCard.className = "chord-card chord-secondary";
          iiiCard.id = "iii-card";
        } else {
          // Change back to diatonic iii
          romanEl.textContent = "iii";
          nameEl.textContent = rootNote + "m";
          notesEl.textContent = getChordNotes(rootNote, "minor"); // Update notes to minor
          iiiCard.className = "chord-card chord-minor";
          iiiCard.id = "iii-card";
        }
      }

      // --- EVENT LISTENERS ---
      keySelect.addEventListener("change", updateChords);
      iiiCard.addEventListener("click", toggleSecondaryDominant);

      // --- INITIALIZATION ---
      document.body.classList.add("loading");
      updateChords();
      setTimeout(() => {
        document.body.classList.remove("loading");
      }, 100);
    </script>
  </body>
</html>
